<!DOCTYPE html>
<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://d3js.org/d3.v5.min.js"></script>
</head>
<body>
  <canvas id="lineChart"></canvas>
  <script>
    // Use D3.js to load the data from the CSV file
    d3.csv("incidents_per_month.csv").then(function(data) {
      console.log("Loaded data:", data);

      // Extract the dates and counts from the data
      var dates = data.map(function(d) { 
        // Create a Date object from the timestamp
        var date = new Date(d.incident_time);

        // Format the Date object as a string with the month and year
        return date.toLocaleDateString('default', { year: 'numeric', month: 'long' });
      });
      var counts = data.map(function(d) { return +d['0']; });

      console.log("Dates:", dates);
      console.log("Counts:", counts);

      // Create the line chart
      var ctx = document.getElementById('lineChart');
      var myChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: dates,
          datasets: [{
            label: '# of Incidents',
            data: counts,
            borderColor: 'rgba(75, 192, 192, 1)',
            fill: false
          }]
        },
        options: {
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: 'Number of Incidents Over Time'
            }
          },
          scales: {
            x: {
              display: true,
              title: {
                display: true,
                text: 'Date'
              }
            },
            y: {
              display: true,
              title: {
                display: true,
                text: 'Number of Incidents'
              }
            }
          }
        }
      });
    });
  </script>
</body>
</html>
